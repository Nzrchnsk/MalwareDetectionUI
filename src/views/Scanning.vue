<template>
  <div class="scanning-view container">
    <Preloader/>
    <TopBlock Text="Последнее сканирование 1 день назад"/>
    <div class="col-6 scanning-pc">
      <ContentCard Title="Сканирование компьютера" Text="Выберете диски для сканирования" Icon="search"/>
    </div>
    <div class="col-6">
      <div class="upload-to-scanning col-12">
        <label style="width: inherit; height: inherit" for="upload">
          <ContentCard Title="Сканирование файла" Text="Загрузите файл для проверки на наличие вирусов" Icon="file"/>
          <input type="file" id="upload" style="display:none" @change="handleFileUpload($event)">
        </label>
<!--        <button v-on:click="submitFile()">Submit</button>-->
      </div>
    </div>
  </div>
</template>

<script>
import TopBlock from "../components/TopBlock";
import ContentCard from "../components/ContentCard";
import db from "../components/db"
import Preloader from "../components/Preloader";

export default {
  name: "Scanning",
  components: {TopBlock, ContentCard, Preloader},
  data() {
    return {
      data: {
        file: null
      }
    }
  },
  methods: {
    async submitFile() {
      let formData = new FormData();
      formData.append('file', this.data.file);
      try {
        await db.Post('scanning/', formData,
            {
              headers: {
                'Content-Type': 'multipart/form-data',
              }
            });

        // this.$router.push({name: 'modulesDirectory'});
      } catch (e) {
        console.log(e)
      }
      // this.Detection = await db.Post("scanning", [[this.file]]);
    },
    async handleFileUpload(event) {
      this.data.file = event.target.files[0]
      await this.submitFile()
      alert("Файл не заражен!")
      // await this.submitFile();
    }
  }
}

</script>

<style scoped>

.upload-to-scanning label {
  cursor: pointer;
}

.scanning-pc {
  cursor: pointer;
}
</style>